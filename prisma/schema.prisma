// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model roles {
  id                Int                 @id @default(autoincrement())
  role_name         String              @unique
  user              user[]
  access_menu       access_menu[]
  access_department access_department[]
}

model user {
  id        Int       @id @default(autoincrement())
  username  String    @unique
  password  String
  createdAt DateTime? @db.DateTime(0)
  roles     roles?    @relation(fields: [rolesId], references: [id])
  rolesId   Int?
  session   session[]
}

model menu_group {
  id         Int     @id @default(autoincrement())
  menu_group String  @unique
  urut       Int?
  group      Int?
  parent_id  String?
  menu       menu[]
}

model menu {
  id            Int           @id @default(autoincrement())
  menu          String?
  path          String?
  urut          Int?
  menu_group_id Int?
  menu_group    menu_group?   @relation(fields: [menu_group_id], references: [id])
  access_menu   access_menu[]
}

model access_menu {
  id      Int     @id @default(autoincrement())
  menu_id Int?
  menu    menu?   @relation(fields: [menu_id], references: [id])
  action  String?
  role_id Int
  roles   roles   @relation(fields: [role_id], references: [id])

  @@unique([menu_id, role_id])
}

model access_department {
  id            Int        @id @default(autoincrement())
  role_id       Int
  roles         roles      @relation(fields: [role_id], references: [id])
  department_id Int
  department    department @relation(fields: [department_id], references: [id])
}

model session {
  id        Int       @id @default(autoincrement())
  token     String    @unique @db.VarChar(300)
  user_id   Int
  user      user      @relation(fields: [user_id], references: [id])
  createdAt DateTime? @db.DateTime(0)
  expiredAt DateTime? @db.DateTime(0)
  expired   Boolean   @default(false)

  @@unique([user_id, token])
}

model department {
  id                Int                 @id @default(autoincrement())
  nama_department   String
  lot               String?
  latitude          String?
  longitude         String?
  radius            String?
  sub_department    sub_department[]
  access_department access_department[]
  pegawai           pegawai[]
}

model sub_department {
  id                  Int         @id @default(autoincrement())
  nama_sub_department String
  department_id       Int
  department          department? @relation(fields: [department_id], references: [id])
  pegawai             pegawai[]
}

model pegawai {
  id                Int             @id @default(autoincrement())
  panji_id          String?
  nama              String
  nik_ktp           String
  tmp_lahir         String?
  tgl_lahir         DateTime?       @db.Date
  jk                String
  agama             String?
  kebangsaan        String?
  alamat            String?
  rt                String?
  rw                String?
  kel               String?
  kec               String?
  kota              String?
  telp              String?
  status_nikah      String
  tgl_join          DateTime?       @db.Date
  tgl_selesai       DateTime?       @db.Date
  tgl_reset         DateTime?       @db.Date
  email             String?
  position          String?
  npwp              String?
  jenis_bank        String?
  no_rek            String?
  bpjs_tk           String?
  bpjs_kes          String?
  department_id     Int?
  department        department?     @relation(fields: [department_id], references: [id])
  sub_department_id Int?
  sub_department    sub_department? @relation(fields: [sub_department_id], references: [id])
  is_active         Boolean         @default(true)
  is_overtime       Boolean         @default(false)
}
